### Configuration for sending bro to syslog. You may want to load the policy tuning/json-logs.bro
### Glen Dosey <doseyg@r-networks.net>
### 2018-11-07


module(load="imfile" PollingInterval="10")
ruleset(name="bro"){
	action(type="omfwd" Target="192.168.1.123" Port="514" Protocol="tcp" )
	#action(type="omkafka" topic="bro" broker=["192.168.1.123:2181"] confParam=["compression.codec=snappy", "socket.timeout.ms=5", "socket.keepalive.enable=true"] )
	action(type="omfile" file="/var/log/bro/bro.log")
	stop
}
### This is the easy way, but you lose the context of which file the log entry was read from
#input(type="imfile" File="/var/spool/bro/bro/*.log" Tag="bro:" Severity="error" Facility="local7" ruleset="bro")

### This is the hard way. Store the log file name as the syslog tag program name. Comment out any you do not want. 
input(type="imfile" File="/var/spool/bro/bro/conn.log" Tag="bro_conn:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/dce_rpc.log" Tag="bro_dce_rpc:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/dhcp.log" Tag="bro_dhcp:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/dnp3.log" Tag="bro_dnp3:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/dns.log" Tag="bro_dns:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/ftp.log" Tag="bro_ftp:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/http.log" Tag="bro_http:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/irc.log" Tag="bro_irc:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/kerberos.log" Tag="bro_kerberos:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/modbus.log" Tag="bro_modbus:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/modbus_register_change.log" Tag="bro_modbus_register_change:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/mysql.log" Tag="bro_mysql:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/ntlm.log" Tag="bro_ntlm:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/radius.log" Tag="bro_radius:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/rdp.log" Tag="bro_rdp:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/rfb.log" Tag="bro_rfb:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/sip.log" Tag="bro_sip:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/smb_cmd.log" Tag="bro_smb_cmd:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/smb_files.log" Tag="bro_smb_files:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/smb_mapping.log" Tag="bro_smb_mapping:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/smtp.log" Tag="bro_smtp:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/snmp.log" Tag="bro_snmp:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/socks.log" Tag="bro_socks:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/ssh.log" Tag="bro_ssh:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/ssl.log" Tag="bro_ssl:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/syslog.log" Tag="bro_syslog:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/tunnel.log" Tag="bro_tunnel:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/files.log" Tag="bro_files:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/ocsp.log" Tag="bro_ocsp:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/pe.log" Tag="bro_pe:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/x509.log" Tag="bro_x509:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/netcontrol.log" Tag="bro_netcontrol:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/netcontrol_drop.log" Tag="bro_netcontrol_drop:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/netcontrol_shunt.log" Tag="bro_netcontrol_shunt:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/netcontrol_catch_release.log" Tag="bro_netcontrol_catch_release:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/openflow.log" Tag="bro_openflow:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/intel.log" Tag="bro_intel:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/notice.log" Tag="bro_notice:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/notice_alarm.log" Tag="bro_notice_alarm:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/signatures.log" Tag="bro_signatures:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/traceroute.log" Tag="bro_traceroute:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/known_certs.log" Tag="bro_known_certs:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/known_hosts.log" Tag="bro_known_hosts:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/known_modbus.log" Tag="bro_known_modbus:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/known_services.log" Tag="bro_known_services:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/software.log" Tag="bro_software:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/barnyard2.log" Tag="bro_barnyard2:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/dpd.log" Tag="bro_dpd:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/unified2.log" Tag="bro_unified2:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/weird.log" Tag="bro_weird:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/weird_stats.log" Tag="bro_weird_stats:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/broker.log" Tag="bro_broker:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/capture_loss.log" Tag="bro_capture_loss:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/cluster.log" Tag="bro_cluster:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/config.log" Tag="bro_config:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/loaded_scripts.log" Tag="bro_loaded_scripts:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/packet_filter.log" Tag="bro_packet_filter:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/prof.log" Tag="bro_prof:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/reporter.log" Tag="bro_reporter:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/stats.log" Tag="bro_stats:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/stderr.log" Tag="bro_stderr:" Severity="error" Facility="local7" ruleset="bro")
input(type="imfile" File="/var/spool/bro/bro/stdout.log" Tag="bro_stdout:" Severity="error" Facility="local7" ruleset="bro")
